%Q3
clc;
clear all;
Y_12 = 10-j*20;
Y_13 = 10-j*30;
Y_23 = 16-j*32;
Y_33 = Y_13+Y_23;
V_1 = 1.05+j*0;

iter = 0;
S_2 = -4.0-j*2.5;
P_3=2;
V_2 = 1+j*0;
V_m3 = 1.04;
V_3 = 1.04+j*0;
for I=1:10;
    iter = iter+1;
    E_2=V_2;
    E_3=V_3;
    V_2 = (conj(S_2)/conj (V_2)+Y_12*V_1+Y_23*V_3)/(Y_12+Y_23);
    D_V2 = V_2-E_2;
    Q_3 = -imag(conj (V_3)* (Y_33*V_3-Y_13*V_1-Y_23*V_2));
    S_3 = P_3+j*Q_3;
    V_c3 = (conj (S_3)/conj (V_3)+Y_13*V_1+Y_23*V_2)/(Y_13+Y_23);
    V_i3 = imag(V_c3);
    V_r3= sqrt (V_m3*V_m3- V_i3*V_i3);
    V_3 = V_r3 +j*V_i3;
    D_v3 = V_3-E_3;
end
disp("V2="+V_2);
disp("V3="+V_3);
Q_3
I_12 = Y_12*(V_1-V_2);
I_21 = -I_12;
I_13 = Y_13*(V_1-V_3);
I_31 = -I_13;
I_23 = Y_23*(V_2-V_3);
I_32 = -I_23;
S_12 = V_1*conj(I_21);
S_21 = V_2*conj(I_21);
S_13 = V_1*conj (I_13);
S_31 = V_3*conj(I_31);
S_23 = V_2*conj(I_23);
S_32 = V_3*conj(I_32);
I_12_21 = [I_12,I_21]
I_13_31 = [I_13,I_31]
I_23_32 = [I_23,I_32]
S_12_21 = [S_12, S_21 (S_12+S_13) S_12+S_21]
S_13_31 = [S_13, S_31 (S_31+S_32) S_13+S_31]